Args in experiment:
Namespace(W=0.1, activation='gelu', affine=0, alpha1=0.1, alpha2=0.1, alpha3=0.1, batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=128, d_layers=1, d_model=16, data='custom', data_path='national_illness.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.3, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.3, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0025, loss='mse', lradj='constant', model='VanDerPol', model_id='104_48', moving_avg=25, n_heads=4, num_workers=10, output_attention=False, padding_patch='end', patch_len=24, patience=20, pct_start=0.3, pred_len=48, random_seed=2021, revin=1, root_path='./dataset/', seq_len=104, stride=2, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 104_48_VanDerPol_custom_ftM_sl104_ll48_pl48_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 525
val 50
test 146
Epoch: 1 cost time: 1.1858603954315186
Epoch: 1, Steps: 32 | Train Loss: 1.0467311 Vali Loss: 1.0888015 Test Loss: 7.4111252
Validation loss decreased (inf --> 1.088802).  Saving model ...
Updating learning rate to 0.0025
Epoch: 2 cost time: 0.9252927303314209
Epoch: 2, Steps: 32 | Train Loss: 0.9753230 Vali Loss: 0.7611920 Test Loss: 6.0802379
Validation loss decreased (1.088802 --> 0.761192).  Saving model ...
Updating learning rate to 0.0025
Epoch: 3 cost time: 1.0427355766296387
Epoch: 3, Steps: 32 | Train Loss: 0.8464047 Vali Loss: 0.6120393 Test Loss: 5.1405506
Validation loss decreased (0.761192 --> 0.612039).  Saving model ...
Updating learning rate to 0.0025
Epoch: 4 cost time: 0.9837563037872314
Epoch: 4, Steps: 32 | Train Loss: 0.7177129 Vali Loss: 0.3408114 Test Loss: 4.3991098
Validation loss decreased (0.612039 --> 0.340811).  Saving model ...
Updating learning rate to 0.0025
Epoch: 5 cost time: 0.9902281761169434
Epoch: 5, Steps: 32 | Train Loss: 0.5748671 Vali Loss: 0.2645170 Test Loss: 3.9900327
Validation loss decreased (0.340811 --> 0.264517).  Saving model ...
Updating learning rate to 0.0025
Epoch: 6 cost time: 1.0005745887756348
Epoch: 6, Steps: 32 | Train Loss: 0.5312633 Vali Loss: 0.2457437 Test Loss: 3.7022328
Validation loss decreased (0.264517 --> 0.245744).  Saving model ...
Updating learning rate to 0.0025
Epoch: 7 cost time: 1.0100970268249512
Epoch: 7, Steps: 32 | Train Loss: 0.5174249 Vali Loss: 0.2922657 Test Loss: 3.6869910
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0025
Epoch: 8 cost time: 0.9548733234405518
Epoch: 8, Steps: 32 | Train Loss: 0.5005293 Vali Loss: 0.2906885 Test Loss: 3.7428029
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0025
Epoch: 9 cost time: 0.9296600818634033
Epoch: 9, Steps: 32 | Train Loss: 0.4943409 Vali Loss: 0.3000746 Test Loss: 3.5676346
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0025
Epoch: 10 cost time: 0.999967098236084
Epoch: 10, Steps: 32 | Train Loss: 0.4763848 Vali Loss: 0.3188461 Test Loss: 3.5557382
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0025
Epoch: 11 cost time: 1.0554540157318115
Epoch: 11, Steps: 32 | Train Loss: 0.4742869 Vali Loss: 0.2545820 Test Loss: 3.6470735
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0025
Epoch: 12 cost time: 1.2049386501312256
Epoch: 12, Steps: 32 | Train Loss: 0.4623714 Vali Loss: 0.3186528 Test Loss: 3.5279939
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0025
Epoch: 13 cost time: 1.0361690521240234
Epoch: 13, Steps: 32 | Train Loss: 0.4394250 Vali Loss: 0.3229696 Test Loss: 3.5004745
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0025
Epoch: 14 cost time: 1.1388468742370605
Epoch: 14, Steps: 32 | Train Loss: 0.4492787 Vali Loss: 0.3304184 Test Loss: 3.4514811
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.0025
Epoch: 15 cost time: 0.9770941734313965
Epoch: 15, Steps: 32 | Train Loss: 0.4362324 Vali Loss: 0.2806696 Test Loss: 3.5212381
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0025
Epoch: 16 cost time: 1.0148813724517822
Epoch: 16, Steps: 32 | Train Loss: 0.4297768 Vali Loss: 0.3109640 Test Loss: 3.4434528
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0025
Epoch: 17 cost time: 0.959824800491333
Epoch: 17, Steps: 32 | Train Loss: 0.4206016 Vali Loss: 0.3149396 Test Loss: 3.3861127
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0025
Epoch: 18 cost time: 0.9438848495483398
Epoch: 18, Steps: 32 | Train Loss: 0.4264165 Vali Loss: 0.3267041 Test Loss: 3.3689117
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.0025
Epoch: 19 cost time: 0.8885126113891602
Epoch: 19, Steps: 32 | Train Loss: 0.4240247 Vali Loss: 0.3578269 Test Loss: 3.4723117
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.0025
Epoch: 20 cost time: 0.9350216388702393
Epoch: 20, Steps: 32 | Train Loss: 0.4172481 Vali Loss: 0.3004085 Test Loss: 3.4759617
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.0025
Epoch: 21 cost time: 0.8649096488952637
Epoch: 21, Steps: 32 | Train Loss: 0.4130663 Vali Loss: 0.2987119 Test Loss: 3.4746771
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.0025
Epoch: 22 cost time: 0.8239774703979492
Epoch: 22, Steps: 32 | Train Loss: 0.4046538 Vali Loss: 0.3411557 Test Loss: 3.5435088
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.0025
Epoch: 23 cost time: 1.0463953018188477
Epoch: 23, Steps: 32 | Train Loss: 0.4079007 Vali Loss: 0.3009157 Test Loss: 3.5107059
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.0025
Epoch: 24 cost time: 1.0532495975494385
Epoch: 24, Steps: 32 | Train Loss: 0.4049683 Vali Loss: 0.2845066 Test Loss: 3.4338903
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.0025
Epoch: 25 cost time: 1.0117442607879639
Epoch: 25, Steps: 32 | Train Loss: 0.4048660 Vali Loss: 0.3122777 Test Loss: 3.6319551
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.0025
Epoch: 26 cost time: 0.9900767803192139
Epoch: 26, Steps: 32 | Train Loss: 0.3970237 Vali Loss: 0.3134979 Test Loss: 3.5260613
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 104_48_VanDerPol_custom_ftM_sl104_ll48_pl48_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 146
mse:3.7019386291503906, mae:1.3504265546798706, rse:0.9203829765319824
