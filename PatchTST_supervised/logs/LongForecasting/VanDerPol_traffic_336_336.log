Args in experiment:
Namespace(W=0.1, activation='gelu', affine=0, alpha1=0.1, alpha2=0.1, alpha3=0.1, batch_size=24, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='custom', data_path='traffic.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=862, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='VanDerPol', model_id='336_336', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=10, pct_start=0.2, pred_len=336, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_336_VanDerPol_custom_ftM_sl336_ll48_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11609
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 1.0255978
	speed: 0.1679s/iter; left time: 8090.9911s
	iters: 200, epoch: 1 | loss: 1.0220697
	speed: 0.1580s/iter; left time: 7597.7664s
	iters: 300, epoch: 1 | loss: 0.9684373
	speed: 0.1607s/iter; left time: 7711.5093s
	iters: 400, epoch: 1 | loss: 0.8450918
	speed: 0.1574s/iter; left time: 7541.9077s
Epoch: 1 cost time: 77.40782570838928
Epoch: 1, Steps: 483 | Train Loss: 0.9670569 Vali Loss: 1.0316156 Test Loss: 1.2923440
Validation loss decreased (inf --> 1.031616).  Saving model ...
Updating learning rate to 4.5910817705587865e-06
	iters: 100, epoch: 2 | loss: 0.6985145
	speed: 0.4703s/iter; left time: 22442.9310s
	iters: 200, epoch: 2 | loss: 0.6380414
	speed: 0.1539s/iter; left time: 7329.7945s
	iters: 300, epoch: 2 | loss: 0.6141436
	speed: 0.1518s/iter; left time: 7211.7118s
	iters: 400, epoch: 2 | loss: 0.6107967
	speed: 0.1523s/iter; left time: 7223.7859s
Epoch: 2 cost time: 75.29864168167114
Epoch: 2, Steps: 483 | Train Loss: 0.6440624 Vali Loss: 0.8352774 Test Loss: 1.1245912
Validation loss decreased (1.031616 --> 0.835277).  Saving model ...
Updating learning rate to 6.349769679756483e-06
	iters: 100, epoch: 3 | loss: 0.5792281
	speed: 0.5057s/iter; left time: 23888.0171s
	iters: 200, epoch: 3 | loss: 0.5506939
	speed: 0.1545s/iter; left time: 7283.6567s
	iters: 300, epoch: 3 | loss: 0.5715042
	speed: 0.1549s/iter; left time: 7286.7087s
	iters: 400, epoch: 3 | loss: 0.5619551
	speed: 0.1538s/iter; left time: 7220.5076s
Epoch: 3 cost time: 76.53481221199036
Epoch: 3, Steps: 483 | Train Loss: 0.5648587 Vali Loss: 0.8048869 Test Loss: 1.0851831
Validation loss decreased (0.835277 --> 0.804887).  Saving model ...
Updating learning rate to 9.232750045791923e-06
	iters: 100, epoch: 4 | loss: 0.5529063
	speed: 0.4835s/iter; left time: 22602.8409s
	iters: 200, epoch: 4 | loss: 0.5403142
	speed: 0.1435s/iter; left time: 6695.1638s
	iters: 300, epoch: 4 | loss: 0.5493664
	speed: 0.1443s/iter; left time: 6716.3768s
	iters: 400, epoch: 4 | loss: 0.5575277
	speed: 0.1419s/iter; left time: 6593.7749s
Epoch: 4 cost time: 71.13070607185364
Epoch: 4, Steps: 483 | Train Loss: 0.5468194 Vali Loss: 0.7908978 Test Loss: 1.0632185
Validation loss decreased (0.804887 --> 0.790898).  Saving model ...
Updating learning rate to 1.316901965452998e-05
	iters: 100, epoch: 5 | loss: 0.5560967
	speed: 0.4769s/iter; left time: 22066.7099s
	iters: 200, epoch: 5 | loss: 0.5078700
	speed: 0.1473s/iter; left time: 6800.0259s
	iters: 300, epoch: 5 | loss: 0.5162579
	speed: 0.1484s/iter; left time: 6838.5405s
	iters: 400, epoch: 5 | loss: 0.4927153
	speed: 0.1442s/iter; left time: 6630.5160s
Epoch: 5 cost time: 72.66593265533447
Epoch: 5, Steps: 483 | Train Loss: 0.5204814 Vali Loss: 0.7531845 Test Loss: 1.0185318
Validation loss decreased (0.790898 --> 0.753184).  Saving model ...
Updating learning rate to 1.8061634455565263e-05
	iters: 100, epoch: 6 | loss: 0.4622491
	speed: 0.4857s/iter; left time: 22240.0472s
	iters: 200, epoch: 6 | loss: 0.4704979
	speed: 0.1493s/iter; left time: 6820.3455s
	iters: 300, epoch: 6 | loss: 0.4705653
	speed: 0.1466s/iter; left time: 6681.9263s
	iters: 400, epoch: 6 | loss: 0.4503687
	speed: 0.1460s/iter; left time: 6641.2580s
Epoch: 6 cost time: 73.28733468055725
Epoch: 6, Steps: 483 | Train Loss: 0.4620500 Vali Loss: 0.7054018 Test Loss: 0.9555496
Validation loss decreased (0.753184 --> 0.705402).  Saving model ...
Updating learning rate to 2.3790097139762028e-05
	iters: 100, epoch: 7 | loss: 0.4044271
	speed: 0.4983s/iter; left time: 22574.3105s
	iters: 200, epoch: 7 | loss: 0.4221119
	speed: 0.1539s/iter; left time: 6956.7102s
	iters: 300, epoch: 7 | loss: 0.4105904
	speed: 0.1560s/iter; left time: 7035.7040s
	iters: 400, epoch: 7 | loss: 0.3934256
	speed: 0.1583s/iter; left time: 7123.7222s
Epoch: 7 cost time: 77.192795753479
Epoch: 7, Steps: 483 | Train Loss: 0.4126798 Vali Loss: 0.6734630 Test Loss: 0.9113619
Validation loss decreased (0.705402 --> 0.673463).  Saving model ...
Updating learning rate to 3.0213324796038823e-05
	iters: 100, epoch: 8 | loss: 0.3749049
	speed: 0.5047s/iter; left time: 22622.7463s
	iters: 200, epoch: 8 | loss: 0.3838930
	speed: 0.1502s/iter; left time: 6718.5861s
	iters: 300, epoch: 8 | loss: 0.3580168
	speed: 0.1561s/iter; left time: 6963.8423s
	iters: 400, epoch: 8 | loss: 0.3594433
	speed: 0.1535s/iter; left time: 6834.1202s
Epoch: 8 cost time: 75.96283841133118
Epoch: 8, Steps: 483 | Train Loss: 0.3686915 Vali Loss: 0.6488417 Test Loss: 0.8919222
Validation loss decreased (0.673463 --> 0.648842).  Saving model ...
Updating learning rate to 3.717312355873837e-05
	iters: 100, epoch: 9 | loss: 0.3531250
	speed: 0.5051s/iter; left time: 22392.4077s
	iters: 200, epoch: 9 | loss: 0.3273914
	speed: 0.1549s/iter; left time: 6854.0689s
	iters: 300, epoch: 9 | loss: 0.3230478
	speed: 0.1556s/iter; left time: 6867.3178s
	iters: 400, epoch: 9 | loss: 0.3246934
	speed: 0.1523s/iter; left time: 6705.6146s
Epoch: 9 cost time: 76.53269410133362
Epoch: 9, Steps: 483 | Train Loss: 0.3345559 Vali Loss: 0.6369488 Test Loss: 0.8842615
Validation loss decreased (0.648842 --> 0.636949).  Saving model ...
Updating learning rate to 4.44980846705528e-05
	iters: 100, epoch: 10 | loss: 0.3142788
	speed: 0.5070s/iter; left time: 22235.3336s
	iters: 200, epoch: 10 | loss: 0.3263384
	speed: 0.1524s/iter; left time: 6666.3391s
	iters: 300, epoch: 10 | loss: 0.3019126
	speed: 0.1526s/iter; left time: 6662.8047s
	iters: 400, epoch: 10 | loss: 0.2932538
	speed: 0.1529s/iter; left time: 6659.2090s
Epoch: 10 cost time: 75.75655007362366
Epoch: 10, Steps: 483 | Train Loss: 0.3085051 Vali Loss: 0.6229421 Test Loss: 0.8723537
Validation loss decreased (0.636949 --> 0.622942).  Saving model ...
Updating learning rate to 5.200780600718023e-05
	iters: 100, epoch: 11 | loss: 0.2917653
	speed: 0.4969s/iter; left time: 21552.9569s
	iters: 200, epoch: 11 | loss: 0.2826903
	speed: 0.1450s/iter; left time: 6272.4521s
	iters: 300, epoch: 11 | loss: 0.2794888
	speed: 0.1521s/iter; left time: 6565.0014s
	iters: 400, epoch: 11 | loss: 0.2918938
	speed: 0.1522s/iter; left time: 6555.3761s
Epoch: 11 cost time: 74.41204762458801
Epoch: 11, Steps: 483 | Train Loss: 0.2890595 Vali Loss: 0.6185308 Test Loss: 0.8748512
Validation loss decreased (0.622942 --> 0.618531).  Saving model ...
Updating learning rate to 5.951733509428494e-05
	iters: 100, epoch: 12 | loss: 0.2883103
	speed: 0.4951s/iter; left time: 21232.6808s
	iters: 200, epoch: 12 | loss: 0.2736113
	speed: 0.1567s/iter; left time: 6705.5111s
	iters: 300, epoch: 12 | loss: 0.2776281
	speed: 0.1534s/iter; left time: 6549.4416s
	iters: 400, epoch: 12 | loss: 0.2730046
	speed: 0.1547s/iter; left time: 6589.7611s
Epoch: 12 cost time: 76.51683688163757
Epoch: 12, Steps: 483 | Train Loss: 0.2755723 Vali Loss: 0.6274231 Test Loss: 0.8528346
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.684172419233074e-05
	iters: 100, epoch: 13 | loss: 0.2682493
	speed: 0.4927s/iter; left time: 20894.6156s
	iters: 200, epoch: 13 | loss: 0.2781413
	speed: 0.1491s/iter; left time: 6307.9528s
	iters: 300, epoch: 13 | loss: 0.2767284
	speed: 0.1536s/iter; left time: 6483.5738s
	iters: 400, epoch: 13 | loss: 0.2584319
	speed: 0.1493s/iter; left time: 6284.5355s
Epoch: 13 cost time: 74.74414896965027
Epoch: 13, Steps: 483 | Train Loss: 0.2656995 Vali Loss: 0.6343895 Test Loss: 0.9151453
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.380058526480372e-05
	iters: 100, epoch: 14 | loss: 0.2524560
	speed: 0.4808s/iter; left time: 20158.0572s
	iters: 200, epoch: 14 | loss: 0.2598137
	speed: 0.1474s/iter; left time: 6165.1443s
	iters: 300, epoch: 14 | loss: 0.2369089
	speed: 0.1558s/iter; left time: 6501.3379s
	iters: 400, epoch: 14 | loss: 0.2531693
	speed: 0.1586s/iter; left time: 6599.2614s
Epoch: 14 cost time: 74.86689329147339
Epoch: 14, Steps: 483 | Train Loss: 0.2576049 Vali Loss: 0.6226192 Test Loss: 0.8881803
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.022253264821264e-05
	iters: 100, epoch: 15 | loss: 0.2566507
	speed: 0.4759s/iter; left time: 19720.3258s
	iters: 200, epoch: 15 | loss: 0.2484280
	speed: 0.1557s/iter; left time: 6437.5360s
	iters: 300, epoch: 15 | loss: 0.2470773
	speed: 0.1548s/iter; left time: 6385.8345s
	iters: 400, epoch: 15 | loss: 0.2503512
	speed: 0.1546s/iter; left time: 6358.9537s
Epoch: 15 cost time: 75.49763607978821
Epoch: 15, Steps: 483 | Train Loss: 0.2514666 Vali Loss: 0.6261227 Test Loss: 0.9055837
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.594940400798161e-05
	iters: 100, epoch: 16 | loss: 0.2466903
	speed: 0.4986s/iter; left time: 20421.1514s
	iters: 200, epoch: 16 | loss: 0.2537765
	speed: 0.1529s/iter; left time: 6247.8678s
	iters: 300, epoch: 16 | loss: 0.2468263
	speed: 0.1557s/iter; left time: 6343.8158s
	iters: 400, epoch: 16 | loss: 0.2505024
	speed: 0.1563s/iter; left time: 6353.8438s
Epoch: 16 cost time: 76.34904885292053
Epoch: 16, Steps: 483 | Train Loss: 0.2462220 Vali Loss: 0.6328891 Test Loss: 0.9055560
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.084015562481504e-05
	iters: 100, epoch: 17 | loss: 0.2381188
	speed: 0.4844s/iter; left time: 19604.6598s
	iters: 200, epoch: 17 | loss: 0.2417173
	speed: 0.1548s/iter; left time: 6247.9720s
	iters: 300, epoch: 17 | loss: 0.2485252
	speed: 0.1524s/iter; left time: 6139.3482s
	iters: 400, epoch: 17 | loss: 0.2533030
	speed: 0.1547s/iter; left time: 6214.9888s
Epoch: 17 cost time: 75.29540705680847
Epoch: 17, Steps: 483 | Train Loss: 0.2412362 Vali Loss: 0.6384558 Test Loss: 0.9289197
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.477433607683623e-05
	iters: 100, epoch: 18 | loss: 0.2366360
	speed: 0.5071s/iter; left time: 20278.7133s
	iters: 200, epoch: 18 | loss: 0.2279359
	speed: 0.1488s/iter; left time: 5935.6872s
	iters: 300, epoch: 18 | loss: 0.2265251
	speed: 0.1505s/iter; left time: 5988.9353s
	iters: 400, epoch: 18 | loss: 0.2393589
	speed: 0.1530s/iter; left time: 6072.2015s
Epoch: 18 cost time: 74.49180102348328
Epoch: 18, Steps: 483 | Train Loss: 0.2377371 Vali Loss: 0.6448442 Test Loss: 0.9161031
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765505276624188e-05
	iters: 100, epoch: 19 | loss: 0.2277110
	speed: 0.4889s/iter; left time: 19315.2683s
	iters: 200, epoch: 19 | loss: 0.2339889
	speed: 0.1517s/iter; left time: 5979.7387s
	iters: 300, epoch: 19 | loss: 0.2203044
	speed: 0.1585s/iter; left time: 6231.3396s
	iters: 400, epoch: 19 | loss: 0.2386978
	speed: 0.1574s/iter; left time: 6170.7905s
Epoch: 19 cost time: 76.2938723564148
Epoch: 19, Steps: 483 | Train Loss: 0.2333701 Vali Loss: 0.6531724 Test Loss: 0.9531476
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.941135822964652e-05
	iters: 100, epoch: 20 | loss: 0.2195472
	speed: 0.4914s/iter; left time: 19177.2928s
	iters: 200, epoch: 20 | loss: 0.2537644
	speed: 0.1512s/iter; left time: 5884.9736s
	iters: 300, epoch: 20 | loss: 0.2261168
	speed: 0.1509s/iter; left time: 5859.0671s
	iters: 400, epoch: 20 | loss: 0.2240152
	speed: 0.1575s/iter; left time: 6100.1834s
Epoch: 20 cost time: 75.37175393104553
Epoch: 20, Steps: 483 | Train Loss: 0.2309042 Vali Loss: 0.6327310 Test Loss: 0.9084599
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.999999983474152e-05
	iters: 100, epoch: 21 | loss: 0.2305603
	speed: 0.4952s/iter; left time: 19086.6161s
	iters: 200, epoch: 21 | loss: 0.2128309
	speed: 0.1568s/iter; left time: 6027.3386s
	iters: 300, epoch: 21 | loss: 0.2360520
	speed: 0.1548s/iter; left time: 5935.6528s
	iters: 400, epoch: 21 | loss: 0.2296707
	speed: 0.1539s/iter; left time: 5883.5575s
Epoch: 21 cost time: 76.23431515693665
Epoch: 21, Steps: 483 | Train Loss: 0.2264821 Vali Loss: 0.6554792 Test Loss: 0.9529122
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : 336_336_VanDerPol_custom_ftM_sl336_ll48_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
mse:0.8748536705970764, mae:0.5381556153297424, rse:0.768532395362854
