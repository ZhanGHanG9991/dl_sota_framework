Args in experiment:
Namespace(W=0.1, activation='gelu', affine=0, alpha1=0.1, alpha2=0.1, alpha3=0.1, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=128, d_layers=1, d_model=16, data='ETTh1', data_path='ETTh1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.3, e_layers=3, embed='timeF', embed_type=0, enc_in=1, factor=1, fc_dropout=0.3, features='S', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='PatchTST', model_id='336_336', moving_avg=25, n_heads=4, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.3, pred_len=336, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_336_PatchTST_ETTh1_ftS_sl336_ll48_pl336_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7969
val 2545
test 2545
Epoch: 1 cost time: 2.6214654445648193
Epoch: 1, Steps: 62 | Train Loss: 0.2773346 Vali Loss: 0.1677693 Test Loss: 0.0911213
Validation loss decreased (inf --> 0.167769).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 2.296804904937744
Epoch: 2, Steps: 62 | Train Loss: 0.2490462 Vali Loss: 0.1463759 Test Loss: 0.0917147
Validation loss decreased (0.167769 --> 0.146376).  Saving model ...
Updating learning rate to 0.0001
Epoch: 3 cost time: 1.8985950946807861
Epoch: 3, Steps: 62 | Train Loss: 0.2205262 Vali Loss: 0.1405472 Test Loss: 0.0901707
Validation loss decreased (0.146376 --> 0.140547).  Saving model ...
Updating learning rate to 0.0001
Epoch: 4 cost time: 2.0713887214660645
Epoch: 4, Steps: 62 | Train Loss: 0.2097802 Vali Loss: 0.1366022 Test Loss: 0.0883048
Validation loss decreased (0.140547 --> 0.136602).  Saving model ...
Updating learning rate to 9e-05
Epoch: 5 cost time: 2.0267550945281982
Epoch: 5, Steps: 62 | Train Loss: 0.2042816 Vali Loss: 0.1347674 Test Loss: 0.0861618
Validation loss decreased (0.136602 --> 0.134767).  Saving model ...
Updating learning rate to 8.1e-05
Epoch: 6 cost time: 1.9803717136383057
Epoch: 6, Steps: 62 | Train Loss: 0.2012083 Vali Loss: 0.1342541 Test Loss: 0.0857691
Validation loss decreased (0.134767 --> 0.134254).  Saving model ...
Updating learning rate to 7.290000000000001e-05
Epoch: 7 cost time: 2.5454463958740234
Epoch: 7, Steps: 62 | Train Loss: 0.1994163 Vali Loss: 0.1331677 Test Loss: 0.0853100
Validation loss decreased (0.134254 --> 0.133168).  Saving model ...
Updating learning rate to 6.561e-05
Epoch: 8 cost time: 1.900655746459961
Epoch: 8, Steps: 62 | Train Loss: 0.1978308 Vali Loss: 0.1326630 Test Loss: 0.0845927
Validation loss decreased (0.133168 --> 0.132663).  Saving model ...
Updating learning rate to 5.904900000000001e-05
Epoch: 9 cost time: 2.0525052547454834
Epoch: 9, Steps: 62 | Train Loss: 0.1965993 Vali Loss: 0.1316490 Test Loss: 0.0839577
Validation loss decreased (0.132663 --> 0.131649).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
Epoch: 10 cost time: 2.0288596153259277
Epoch: 10, Steps: 62 | Train Loss: 0.1955862 Vali Loss: 0.1317309 Test Loss: 0.0838475
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.782969000000001e-05
Epoch: 11 cost time: 2.1393330097198486
Epoch: 11, Steps: 62 | Train Loss: 0.1948048 Vali Loss: 0.1312276 Test Loss: 0.0836637
Validation loss decreased (0.131649 --> 0.131228).  Saving model ...
Updating learning rate to 4.304672100000001e-05
Epoch: 12 cost time: 2.1962807178497314
Epoch: 12, Steps: 62 | Train Loss: 0.1941500 Vali Loss: 0.1310819 Test Loss: 0.0830289
Validation loss decreased (0.131228 --> 0.131082).  Saving model ...
Updating learning rate to 3.874204890000001e-05
Epoch: 13 cost time: 1.8511502742767334
Epoch: 13, Steps: 62 | Train Loss: 0.1936727 Vali Loss: 0.1309369 Test Loss: 0.0830220
Validation loss decreased (0.131082 --> 0.130937).  Saving model ...
Updating learning rate to 3.486784401000001e-05
Epoch: 14 cost time: 2.0493671894073486
Epoch: 14, Steps: 62 | Train Loss: 0.1926586 Vali Loss: 0.1306536 Test Loss: 0.0824342
Validation loss decreased (0.130937 --> 0.130654).  Saving model ...
Updating learning rate to 3.138105960900001e-05
Epoch: 15 cost time: 2.023037910461426
Epoch: 15, Steps: 62 | Train Loss: 0.1925426 Vali Loss: 0.1306300 Test Loss: 0.0827109
Validation loss decreased (0.130654 --> 0.130630).  Saving model ...
Updating learning rate to 2.824295364810001e-05
Epoch: 16 cost time: 2.3792569637298584
Epoch: 16, Steps: 62 | Train Loss: 0.1919589 Vali Loss: 0.1301390 Test Loss: 0.0823350
Validation loss decreased (0.130630 --> 0.130139).  Saving model ...
Updating learning rate to 2.541865828329001e-05
Epoch: 17 cost time: 1.9786653518676758
Epoch: 17, Steps: 62 | Train Loss: 0.1914607 Vali Loss: 0.1299107 Test Loss: 0.0820207
Validation loss decreased (0.130139 --> 0.129911).  Saving model ...
Updating learning rate to 2.287679245496101e-05
Epoch: 18 cost time: 2.000170946121216
Epoch: 18, Steps: 62 | Train Loss: 0.1914576 Vali Loss: 0.1302011 Test Loss: 0.0822218
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.0589113209464907e-05
Epoch: 19 cost time: 2.05454158782959
Epoch: 19, Steps: 62 | Train Loss: 0.1906947 Vali Loss: 0.1303168 Test Loss: 0.0819749
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.8530201888518416e-05
Epoch: 20 cost time: 2.0782763957977295
Epoch: 20, Steps: 62 | Train Loss: 0.1904395 Vali Loss: 0.1300434 Test Loss: 0.0818656
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.6677181699666577e-05
Epoch: 21 cost time: 2.4644877910614014
Epoch: 21, Steps: 62 | Train Loss: 0.1900173 Vali Loss: 0.1298843 Test Loss: 0.0817821
Validation loss decreased (0.129911 --> 0.129884).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
Epoch: 22 cost time: 1.8210067749023438
Epoch: 22, Steps: 62 | Train Loss: 0.1899078 Vali Loss: 0.1299672 Test Loss: 0.0815927
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.3508517176729929e-05
Epoch: 23 cost time: 2.026970624923706
Epoch: 23, Steps: 62 | Train Loss: 0.1896953 Vali Loss: 0.1300422 Test Loss: 0.0817132
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.2157665459056936e-05
Epoch: 24 cost time: 1.968630313873291
Epoch: 24, Steps: 62 | Train Loss: 0.1898657 Vali Loss: 0.1297978 Test Loss: 0.0815097
Validation loss decreased (0.129884 --> 0.129798).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
Epoch: 25 cost time: 2.204944133758545
Epoch: 25, Steps: 62 | Train Loss: 0.1892166 Vali Loss: 0.1297889 Test Loss: 0.0812966
Validation loss decreased (0.129798 --> 0.129789).  Saving model ...
Updating learning rate to 9.847709021836118e-06
Epoch: 26 cost time: 3.167694568634033
Epoch: 26, Steps: 62 | Train Loss: 0.1894195 Vali Loss: 0.1300158 Test Loss: 0.0815096
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.862938119652508e-06
Epoch: 27 cost time: 1.8773438930511475
Epoch: 27, Steps: 62 | Train Loss: 0.1889173 Vali Loss: 0.1298848 Test Loss: 0.0813542
EarlyStopping counter: 2 out of 20
Updating learning rate to 7.976644307687255e-06
Epoch: 28 cost time: 1.9182970523834229
Epoch: 28, Steps: 62 | Train Loss: 0.1886396 Vali Loss: 0.1301354 Test Loss: 0.0812337
EarlyStopping counter: 3 out of 20
Updating learning rate to 7.178979876918531e-06
Epoch: 29 cost time: 2.0290825366973877
Epoch: 29, Steps: 62 | Train Loss: 0.1889258 Vali Loss: 0.1301779 Test Loss: 0.0812566
EarlyStopping counter: 4 out of 20
Updating learning rate to 6.4610818892266776e-06
Epoch: 30 cost time: 2.0472207069396973
Epoch: 30, Steps: 62 | Train Loss: 0.1886995 Vali Loss: 0.1301437 Test Loss: 0.0812210
EarlyStopping counter: 5 out of 20
Updating learning rate to 5.8149737003040096e-06
Epoch: 31 cost time: 2.3693294525146484
Epoch: 31, Steps: 62 | Train Loss: 0.1886000 Vali Loss: 0.1300716 Test Loss: 0.0812282
EarlyStopping counter: 6 out of 20
Updating learning rate to 5.23347633027361e-06
Epoch: 32 cost time: 1.946861982345581
Epoch: 32, Steps: 62 | Train Loss: 0.1882799 Vali Loss: 0.1300479 Test Loss: 0.0812442
EarlyStopping counter: 7 out of 20
Updating learning rate to 4.710128697246249e-06
Epoch: 33 cost time: 1.9450328350067139
Epoch: 33, Steps: 62 | Train Loss: 0.1882971 Vali Loss: 0.1299713 Test Loss: 0.0811395
EarlyStopping counter: 8 out of 20
Updating learning rate to 4.239115827521624e-06
Epoch: 34 cost time: 2.0048532485961914
Epoch: 34, Steps: 62 | Train Loss: 0.1882172 Vali Loss: 0.1300921 Test Loss: 0.0811964
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.815204244769462e-06
Epoch: 35 cost time: 1.9867010116577148
Epoch: 35, Steps: 62 | Train Loss: 0.1885262 Vali Loss: 0.1299634 Test Loss: 0.0810914
EarlyStopping counter: 10 out of 20
Updating learning rate to 3.4336838202925152e-06
Epoch: 36 cost time: 2.213371515274048
Epoch: 36, Steps: 62 | Train Loss: 0.1882180 Vali Loss: 0.1294617 Test Loss: 0.0811568
Validation loss decreased (0.129789 --> 0.129462).  Saving model ...
Updating learning rate to 3.090315438263264e-06
Epoch: 37 cost time: 2.0142199993133545
Epoch: 37, Steps: 62 | Train Loss: 0.1881874 Vali Loss: 0.1296856 Test Loss: 0.0810873
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.7812838944369375e-06
Epoch: 38 cost time: 2.0271518230438232
Epoch: 38, Steps: 62 | Train Loss: 0.1881550 Vali Loss: 0.1301069 Test Loss: 0.0811915
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.503155504993244e-06
Epoch: 39 cost time: 2.0365664958953857
Epoch: 39, Steps: 62 | Train Loss: 0.1880198 Vali Loss: 0.1299531 Test Loss: 0.0810542
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.2528399544939195e-06
Epoch: 40 cost time: 2.419480562210083
Epoch: 40, Steps: 62 | Train Loss: 0.1880066 Vali Loss: 0.1295945 Test Loss: 0.0810467
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.0275559590445276e-06
Epoch: 41 cost time: 1.7779316902160645
Epoch: 41, Steps: 62 | Train Loss: 0.1882464 Vali Loss: 0.1297503 Test Loss: 0.0811343
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.8248003631400751e-06
Epoch: 42 cost time: 2.2683751583099365
Epoch: 42, Steps: 62 | Train Loss: 0.1880731 Vali Loss: 0.1296959 Test Loss: 0.0810450
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.6423203268260676e-06
Epoch: 43 cost time: 2.0856475830078125
Epoch: 43, Steps: 62 | Train Loss: 0.1882012 Vali Loss: 0.1299804 Test Loss: 0.0810541
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.4780882941434609e-06
Epoch: 44 cost time: 2.0199012756347656
Epoch: 44, Steps: 62 | Train Loss: 0.1881151 Vali Loss: 0.1295703 Test Loss: 0.0810643
EarlyStopping counter: 8 out of 20
Updating learning rate to 1.3302794647291146e-06
Epoch: 45 cost time: 2.6080245971679688
Epoch: 45, Steps: 62 | Train Loss: 0.1876971 Vali Loss: 0.1295369 Test Loss: 0.0809745
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.1972515182562034e-06
Epoch: 46 cost time: 1.924867868423462
Epoch: 46, Steps: 62 | Train Loss: 0.1878671 Vali Loss: 0.1302287 Test Loss: 0.0810259
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.077526366430583e-06
Epoch: 47 cost time: 2.05614972114563
Epoch: 47, Steps: 62 | Train Loss: 0.1879610 Vali Loss: 0.1300186 Test Loss: 0.0809668
EarlyStopping counter: 11 out of 20
Updating learning rate to 9.697737297875248e-07
Epoch: 48 cost time: 2.026966094970703
Epoch: 48, Steps: 62 | Train Loss: 0.1879761 Vali Loss: 0.1297289 Test Loss: 0.0808972
EarlyStopping counter: 12 out of 20
Updating learning rate to 8.727963568087723e-07
Epoch: 49 cost time: 2.0227701663970947
Epoch: 49, Steps: 62 | Train Loss: 0.1876690 Vali Loss: 0.1297563 Test Loss: 0.0809084
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.855167211278951e-07
Epoch: 50 cost time: 2.772315263748169
Epoch: 50, Steps: 62 | Train Loss: 0.1878267 Vali Loss: 0.1299831 Test Loss: 0.0809938
EarlyStopping counter: 14 out of 20
Updating learning rate to 7.069650490151056e-07
Epoch: 51 cost time: 2.020305633544922
Epoch: 51, Steps: 62 | Train Loss: 0.1877735 Vali Loss: 0.1298976 Test Loss: 0.0811081
EarlyStopping counter: 15 out of 20
Updating learning rate to 6.36268544113595e-07
Epoch: 52 cost time: 2.0337841510772705
Epoch: 52, Steps: 62 | Train Loss: 0.1879470 Vali Loss: 0.1300227 Test Loss: 0.0810176
EarlyStopping counter: 16 out of 20
Updating learning rate to 5.726416897022355e-07
Epoch: 53 cost time: 2.066972017288208
Epoch: 53, Steps: 62 | Train Loss: 0.1877640 Vali Loss: 0.1296529 Test Loss: 0.0809754
EarlyStopping counter: 17 out of 20
Updating learning rate to 5.15377520732012e-07
Epoch: 54 cost time: 2.0691518783569336
Epoch: 54, Steps: 62 | Train Loss: 0.1877423 Vali Loss: 0.1299188 Test Loss: 0.0809206
EarlyStopping counter: 18 out of 20
Updating learning rate to 4.6383976865881085e-07
Epoch: 55 cost time: 2.7112624645233154
Epoch: 55, Steps: 62 | Train Loss: 0.1878216 Vali Loss: 0.1296788 Test Loss: 0.0809244
EarlyStopping counter: 19 out of 20
Updating learning rate to 4.174557917929298e-07
Epoch: 56 cost time: 2.0947611331939697
Epoch: 56, Steps: 62 | Train Loss: 0.1878429 Vali Loss: 0.1299296 Test Loss: 0.0810187
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_336_PatchTST_ETTh1_ftS_sl336_ll48_pl336_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
mse:0.08115676045417786, mae:0.22537197172641754, rse:0.8648074865341187
