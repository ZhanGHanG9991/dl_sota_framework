Args in experiment:
Namespace(W=0.1, activation='gelu', affine=0, alpha1=0.1, alpha2=0.1, alpha3=0.1, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=128, d_layers=1, d_model=16, data='ETTh1', data_path='ETTh1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.3, e_layers=3, embed='timeF', embed_type=0, enc_in=1, factor=1, fc_dropout=0.3, features='S', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='VanDerPol', model_id='336_720', moving_avg=25, n_heads=4, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.3, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_720_VanDerPol_ETTh1_ftS_sl336_ll48_pl720_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
Epoch: 1 cost time: 1.6021850109100342
Epoch: 1, Steps: 59 | Train Loss: 1.0197070 Vali Loss: 0.4069725 Test Loss: 2.1799011
Validation loss decreased (inf --> 0.406972).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 1.512019157409668
Epoch: 2, Steps: 59 | Train Loss: 0.6246281 Vali Loss: 0.3743683 Test Loss: 0.4981205
Validation loss decreased (0.406972 --> 0.374368).  Saving model ...
Updating learning rate to 0.0001
Epoch: 3 cost time: 1.4733238220214844
Epoch: 3, Steps: 59 | Train Loss: 0.4877423 Vali Loss: 0.3429667 Test Loss: 0.5081548
Validation loss decreased (0.374368 --> 0.342967).  Saving model ...
Updating learning rate to 0.0001
Epoch: 4 cost time: 1.2729644775390625
Epoch: 4, Steps: 59 | Train Loss: 0.4709495 Vali Loss: 0.3391226 Test Loss: 0.4938915
Validation loss decreased (0.342967 --> 0.339123).  Saving model ...
Updating learning rate to 9e-05
Epoch: 5 cost time: 1.1204578876495361
Epoch: 5, Steps: 59 | Train Loss: 0.4598711 Vali Loss: 0.3398597 Test Loss: 0.4791731
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.1e-05
Epoch: 6 cost time: 1.1606597900390625
Epoch: 6, Steps: 59 | Train Loss: 0.4513698 Vali Loss: 0.3329407 Test Loss: 0.4794326
Validation loss decreased (0.339123 --> 0.332941).  Saving model ...
Updating learning rate to 7.290000000000001e-05
Epoch: 7 cost time: 1.236476182937622
Epoch: 7, Steps: 59 | Train Loss: 0.4432451 Vali Loss: 0.3312522 Test Loss: 0.4741496
Validation loss decreased (0.332941 --> 0.331252).  Saving model ...
Updating learning rate to 6.561e-05
Epoch: 8 cost time: 1.3661572933197021
Epoch: 8, Steps: 59 | Train Loss: 0.4358375 Vali Loss: 0.3239136 Test Loss: 0.4723486
Validation loss decreased (0.331252 --> 0.323914).  Saving model ...
Updating learning rate to 5.904900000000001e-05
Epoch: 9 cost time: 1.3695073127746582
Epoch: 9, Steps: 59 | Train Loss: 0.4290958 Vali Loss: 0.3296514 Test Loss: 0.4497655
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.3144100000000005e-05
Epoch: 10 cost time: 1.6094698905944824
Epoch: 10, Steps: 59 | Train Loss: 0.4230991 Vali Loss: 0.3233931 Test Loss: 0.4540086
Validation loss decreased (0.323914 --> 0.323393).  Saving model ...
Updating learning rate to 4.782969000000001e-05
Epoch: 11 cost time: 1.5302419662475586
Epoch: 11, Steps: 59 | Train Loss: 0.4186041 Vali Loss: 0.3202175 Test Loss: 0.4559473
Validation loss decreased (0.323393 --> 0.320217).  Saving model ...
Updating learning rate to 4.304672100000001e-05
Epoch: 12 cost time: 1.371370792388916
Epoch: 12, Steps: 59 | Train Loss: 0.4137249 Vali Loss: 0.3180186 Test Loss: 0.4465211
Validation loss decreased (0.320217 --> 0.318019).  Saving model ...
Updating learning rate to 3.874204890000001e-05
Epoch: 13 cost time: 1.5496702194213867
Epoch: 13, Steps: 59 | Train Loss: 0.4096449 Vali Loss: 0.3162949 Test Loss: 0.4484491
Validation loss decreased (0.318019 --> 0.316295).  Saving model ...
Updating learning rate to 3.486784401000001e-05
Epoch: 14 cost time: 1.6379382610321045
Epoch: 14, Steps: 59 | Train Loss: 0.4062904 Vali Loss: 0.3164813 Test Loss: 0.4454710
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.138105960900001e-05
Epoch: 15 cost time: 1.786102294921875
Epoch: 15, Steps: 59 | Train Loss: 0.4030853 Vali Loss: 0.3135482 Test Loss: 0.4386615
Validation loss decreased (0.316295 --> 0.313548).  Saving model ...
Updating learning rate to 2.824295364810001e-05
Epoch: 16 cost time: 1.5022609233856201
Epoch: 16, Steps: 59 | Train Loss: 0.4000601 Vali Loss: 0.3166128 Test Loss: 0.4321827
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.541865828329001e-05
Epoch: 17 cost time: 1.4693841934204102
Epoch: 17, Steps: 59 | Train Loss: 0.3971177 Vali Loss: 0.3079591 Test Loss: 0.4461009
Validation loss decreased (0.313548 --> 0.307959).  Saving model ...
Updating learning rate to 2.287679245496101e-05
Epoch: 18 cost time: 1.5642523765563965
Epoch: 18, Steps: 59 | Train Loss: 0.3949938 Vali Loss: 0.3118278 Test Loss: 0.4356012
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.0589113209464907e-05
Epoch: 19 cost time: 1.6152045726776123
Epoch: 19, Steps: 59 | Train Loss: 0.3931640 Vali Loss: 0.3073931 Test Loss: 0.4344328
Validation loss decreased (0.307959 --> 0.307393).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
Epoch: 20 cost time: 1.4512817859649658
Epoch: 20, Steps: 59 | Train Loss: 0.3906510 Vali Loss: 0.3071268 Test Loss: 0.4295168
Validation loss decreased (0.307393 --> 0.307127).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
Epoch: 21 cost time: 1.4887685775756836
Epoch: 21, Steps: 59 | Train Loss: 0.3891267 Vali Loss: 0.3103937 Test Loss: 0.4267060
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.5009463529699919e-05
Epoch: 22 cost time: 1.618375301361084
Epoch: 22, Steps: 59 | Train Loss: 0.3878977 Vali Loss: 0.3058351 Test Loss: 0.4270585
Validation loss decreased (0.307127 --> 0.305835).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
Epoch: 23 cost time: 1.6006605625152588
Epoch: 23, Steps: 59 | Train Loss: 0.3854042 Vali Loss: 0.3077041 Test Loss: 0.4260564
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.2157665459056936e-05
Epoch: 24 cost time: 1.688204050064087
Epoch: 24, Steps: 59 | Train Loss: 0.3848463 Vali Loss: 0.3047400 Test Loss: 0.4268241
Validation loss decreased (0.305835 --> 0.304740).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
Epoch: 25 cost time: 1.7304553985595703
Epoch: 25, Steps: 59 | Train Loss: 0.3835578 Vali Loss: 0.3024869 Test Loss: 0.4293492
Validation loss decreased (0.304740 --> 0.302487).  Saving model ...
Updating learning rate to 9.847709021836118e-06
Epoch: 26 cost time: 1.6436080932617188
Epoch: 26, Steps: 59 | Train Loss: 0.3835077 Vali Loss: 0.3031406 Test Loss: 0.4233011
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.862938119652508e-06
Epoch: 27 cost time: 1.6956756114959717
Epoch: 27, Steps: 59 | Train Loss: 0.3820066 Vali Loss: 0.3051098 Test Loss: 0.4224579
EarlyStopping counter: 2 out of 20
Updating learning rate to 7.976644307687255e-06
Epoch: 28 cost time: 1.6001298427581787
Epoch: 28, Steps: 59 | Train Loss: 0.3811117 Vali Loss: 0.3010262 Test Loss: 0.4251243
Validation loss decreased (0.302487 --> 0.301026).  Saving model ...
Updating learning rate to 7.178979876918531e-06
Epoch: 29 cost time: 1.796203374862671
Epoch: 29, Steps: 59 | Train Loss: 0.3807703 Vali Loss: 0.3010383 Test Loss: 0.4238643
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.4610818892266776e-06
Epoch: 30 cost time: 1.556652545928955
Epoch: 30, Steps: 59 | Train Loss: 0.3803004 Vali Loss: 0.3014190 Test Loss: 0.4243115
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.8149737003040096e-06
Epoch: 31 cost time: 1.4938256740570068
Epoch: 31, Steps: 59 | Train Loss: 0.3795257 Vali Loss: 0.3037417 Test Loss: 0.4218878
EarlyStopping counter: 3 out of 20
Updating learning rate to 5.23347633027361e-06
Epoch: 32 cost time: 1.4973938465118408
Epoch: 32, Steps: 59 | Train Loss: 0.3788739 Vali Loss: 0.3009887 Test Loss: 0.4230201
Validation loss decreased (0.301026 --> 0.300989).  Saving model ...
Updating learning rate to 4.710128697246249e-06
Epoch: 33 cost time: 1.5613360404968262
Epoch: 33, Steps: 59 | Train Loss: 0.3784691 Vali Loss: 0.3029096 Test Loss: 0.4209588
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.239115827521624e-06
Epoch: 34 cost time: 1.439788818359375
Epoch: 34, Steps: 59 | Train Loss: 0.3777946 Vali Loss: 0.3025216 Test Loss: 0.4225383
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.815204244769462e-06
Epoch: 35 cost time: 1.4566717147827148
Epoch: 35, Steps: 59 | Train Loss: 0.3773706 Vali Loss: 0.3012851 Test Loss: 0.4212617
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.4336838202925152e-06
Epoch: 36 cost time: 1.6645708084106445
Epoch: 36, Steps: 59 | Train Loss: 0.3777348 Vali Loss: 0.3010542 Test Loss: 0.4198071
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.090315438263264e-06
Epoch: 37 cost time: 1.6454460620880127
Epoch: 37, Steps: 59 | Train Loss: 0.3767385 Vali Loss: 0.2993985 Test Loss: 0.4198513
Validation loss decreased (0.300989 --> 0.299399).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
Epoch: 38 cost time: 1.600318193435669
Epoch: 38, Steps: 59 | Train Loss: 0.3763890 Vali Loss: 0.2996542 Test Loss: 0.4227648
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.503155504993244e-06
Epoch: 39 cost time: 1.7448639869689941
Epoch: 39, Steps: 59 | Train Loss: 0.3766858 Vali Loss: 0.3019080 Test Loss: 0.4218108
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.2528399544939195e-06
Epoch: 40 cost time: 1.6147034168243408
Epoch: 40, Steps: 59 | Train Loss: 0.3761101 Vali Loss: 0.2993336 Test Loss: 0.4199563
Validation loss decreased (0.299399 --> 0.299334).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
Epoch: 41 cost time: 1.6761200428009033
Epoch: 41, Steps: 59 | Train Loss: 0.3759479 Vali Loss: 0.2992856 Test Loss: 0.4195672
Validation loss decreased (0.299334 --> 0.299286).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
Epoch: 42 cost time: 1.486708641052246
Epoch: 42, Steps: 59 | Train Loss: 0.3753928 Vali Loss: 0.2987404 Test Loss: 0.4186772
Validation loss decreased (0.299286 --> 0.298740).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
Epoch: 43 cost time: 1.5742948055267334
Epoch: 43, Steps: 59 | Train Loss: 0.3759014 Vali Loss: 0.3006186 Test Loss: 0.4212623
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.4780882941434609e-06
Epoch: 44 cost time: 1.5007414817810059
Epoch: 44, Steps: 59 | Train Loss: 0.3757810 Vali Loss: 0.3005102 Test Loss: 0.4202892
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.3302794647291146e-06
Epoch: 45 cost time: 1.4641976356506348
Epoch: 45, Steps: 59 | Train Loss: 0.3744442 Vali Loss: 0.2999995 Test Loss: 0.4188910
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.1972515182562034e-06
Epoch: 46 cost time: 1.5945587158203125
Epoch: 46, Steps: 59 | Train Loss: 0.3754719 Vali Loss: 0.2997935 Test Loss: 0.4192848
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.077526366430583e-06
Epoch: 47 cost time: 1.3762938976287842
Epoch: 47, Steps: 59 | Train Loss: 0.3756847 Vali Loss: 0.2978074 Test Loss: 0.4190201
Validation loss decreased (0.298740 --> 0.297807).  Saving model ...
Updating learning rate to 9.697737297875248e-07
Epoch: 48 cost time: 1.5338144302368164
Epoch: 48, Steps: 59 | Train Loss: 0.3744151 Vali Loss: 0.2990259 Test Loss: 0.4200250
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.727963568087723e-07
Epoch: 49 cost time: 1.6423301696777344
Epoch: 49, Steps: 59 | Train Loss: 0.3745461 Vali Loss: 0.2994663 Test Loss: 0.4198744
EarlyStopping counter: 2 out of 20
Updating learning rate to 7.855167211278951e-07
Epoch: 50 cost time: 1.5985987186431885
Epoch: 50, Steps: 59 | Train Loss: 0.3750912 Vali Loss: 0.3006612 Test Loss: 0.4192773
EarlyStopping counter: 3 out of 20
Updating learning rate to 7.069650490151056e-07
Epoch: 51 cost time: 1.5940401554107666
Epoch: 51, Steps: 59 | Train Loss: 0.3743358 Vali Loss: 0.2995339 Test Loss: 0.4194208
EarlyStopping counter: 4 out of 20
Updating learning rate to 6.36268544113595e-07
Epoch: 52 cost time: 1.79335618019104
Epoch: 52, Steps: 59 | Train Loss: 0.3744694 Vali Loss: 0.2999610 Test Loss: 0.4188433
EarlyStopping counter: 5 out of 20
Updating learning rate to 5.726416897022355e-07
Epoch: 53 cost time: 1.5271191596984863
Epoch: 53, Steps: 59 | Train Loss: 0.3742165 Vali Loss: 0.2968656 Test Loss: 0.4192616
Validation loss decreased (0.297807 --> 0.296866).  Saving model ...
Updating learning rate to 5.15377520732012e-07
Epoch: 54 cost time: 1.6538784503936768
Epoch: 54, Steps: 59 | Train Loss: 0.3748513 Vali Loss: 0.3008385 Test Loss: 0.4194911
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.6383976865881085e-07
Epoch: 55 cost time: 1.5812196731567383
Epoch: 55, Steps: 59 | Train Loss: 0.3747709 Vali Loss: 0.2988072 Test Loss: 0.4188904
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.174557917929298e-07
Epoch: 56 cost time: 1.509521245956421
Epoch: 56, Steps: 59 | Train Loss: 0.3746918 Vali Loss: 0.2986739 Test Loss: 0.4190612
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.7571021261363677e-07
Epoch: 57 cost time: 1.45167875289917
Epoch: 57, Steps: 59 | Train Loss: 0.3746723 Vali Loss: 0.2987229 Test Loss: 0.4190975
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.381391913522731e-07
Epoch: 58 cost time: 1.4510877132415771
Epoch: 58, Steps: 59 | Train Loss: 0.3740755 Vali Loss: 0.2989606 Test Loss: 0.4190720
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.043252722170458e-07
Epoch: 59 cost time: 1.4917728900909424
Epoch: 59, Steps: 59 | Train Loss: 0.3743330 Vali Loss: 0.2971469 Test Loss: 0.4193487
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.7389274499534124e-07
Epoch: 60 cost time: 1.550584077835083
Epoch: 60, Steps: 59 | Train Loss: 0.3744402 Vali Loss: 0.2993891 Test Loss: 0.4189149
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.465034704958071e-07
Epoch: 61 cost time: 1.6679470539093018
Epoch: 61, Steps: 59 | Train Loss: 0.3739093 Vali Loss: 0.2992594 Test Loss: 0.4190091
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.218531234462264e-07
Epoch: 62 cost time: 1.6927497386932373
Epoch: 62, Steps: 59 | Train Loss: 0.3745374 Vali Loss: 0.2981645 Test Loss: 0.4189404
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.9966781110160376e-07
Epoch: 63 cost time: 1.3955810070037842
Epoch: 63, Steps: 59 | Train Loss: 0.3738690 Vali Loss: 0.2982518 Test Loss: 0.4188089
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.797010299914434e-07
Epoch: 64 cost time: 1.4993386268615723
Epoch: 64, Steps: 59 | Train Loss: 0.3742210 Vali Loss: 0.2987720 Test Loss: 0.4191277
EarlyStopping counter: 11 out of 20
Updating learning rate to 1.6173092699229907e-07
Epoch: 65 cost time: 1.5802652835845947
Epoch: 65, Steps: 59 | Train Loss: 0.3744628 Vali Loss: 0.2970350 Test Loss: 0.4189178
EarlyStopping counter: 12 out of 20
Updating learning rate to 1.4555783429306916e-07
Epoch: 66 cost time: 1.5537629127502441
Epoch: 66, Steps: 59 | Train Loss: 0.3742603 Vali Loss: 0.3009963 Test Loss: 0.4189600
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.3100205086376224e-07
Epoch: 67 cost time: 1.5174853801727295
Epoch: 67, Steps: 59 | Train Loss: 0.3742065 Vali Loss: 0.2985142 Test Loss: 0.4188693
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.1790184577738603e-07
Epoch: 68 cost time: 1.4557504653930664
Epoch: 68, Steps: 59 | Train Loss: 0.3742023 Vali Loss: 0.2993432 Test Loss: 0.4188767
EarlyStopping counter: 15 out of 20
Updating learning rate to 1.0611166119964742e-07
Epoch: 69 cost time: 1.6137230396270752
Epoch: 69, Steps: 59 | Train Loss: 0.3739080 Vali Loss: 0.2980236 Test Loss: 0.4189795
EarlyStopping counter: 16 out of 20
Updating learning rate to 9.550049507968268e-08
Epoch: 70 cost time: 1.5592355728149414
Epoch: 70, Steps: 59 | Train Loss: 0.3732517 Vali Loss: 0.2992384 Test Loss: 0.4189256
EarlyStopping counter: 17 out of 20
Updating learning rate to 8.595044557171442e-08
Epoch: 71 cost time: 1.575347661972046
Epoch: 71, Steps: 59 | Train Loss: 0.3744514 Vali Loss: 0.2996735 Test Loss: 0.4189625
EarlyStopping counter: 18 out of 20
Updating learning rate to 7.735540101454298e-08
Epoch: 72 cost time: 1.4122962951660156
Epoch: 72, Steps: 59 | Train Loss: 0.3736800 Vali Loss: 0.2985392 Test Loss: 0.4188179
EarlyStopping counter: 19 out of 20
Updating learning rate to 6.961986091308869e-08
Epoch: 73 cost time: 1.4082965850830078
Epoch: 73, Steps: 59 | Train Loss: 0.3738170 Vali Loss: 0.3014579 Test Loss: 0.4189058
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_720_VanDerPol_ETTh1_ftS_sl336_ll48_pl720_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.41952136158943176, mae:0.5821777582168579, rse:2.137331485748291
